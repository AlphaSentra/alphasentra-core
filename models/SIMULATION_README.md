# simulation.py Documentation

## Overview
This module provides tools for financial market simulation using Agent-Based Modeling (ABM). It includes:
- Stochastic noise application for realistic variation
- Investor agent implementation with behavioral parameters
- Market simulation engine with price dynamics
- Data processing pipelines for simulation results
- Initial data sample of 1 million simulated market participant profiles generated by AI

## Core Functions

### `apply_stochastic_noise(value: float, scale: float = 0.15) -> float`
Applies Gaussian noise to a value and clamps between -1.0 and 1.0.

**Parameters:**
- `value`: Base value to modify
- `scale`: Standard deviation of noise distribution (default: 0.15)

**Returns:** Noisy value clamped to [-1.0, 1.0]

### `update_simulation_with_stochastic(simulation_data: List[Dict[str, Any]], ...) -> List[Dict[str, Any]]`
Processes simulation data by:
1. Adding noise to existing points
2. Generating synthetic data points
3. Enforcing academic constraints

**Key Parameters:**
- `simulation_data`: Initial investor profiles
- `num_additional_points`: Synthetic points to generate (default: 1000)
- `*_scale`: Noise parameters for different processing stages

## Core Classes

### `Agent` Class
Represents an investor in the market simulation.

**Key Attributes:**
- `conviction`: Rational assessment (-1.0 to 1.0)
- `sentiment`: Emotional bias (-1.0 to 1.0)
- `position`: Current market position (BULLISH/BEARISH/NEUTRAL)
- `risk_aversion`: Willingness to take risks
- `recency_bias`: Tendency to follow recent trends

**Key Methods:**
- `calculate_pnl()`: Updates profit/loss
- `execute_trade()`: Determines new position
- `get_state()`: Returns current agent state

### `MarketSimulator` Class
Manages the market environment and simulation loop.

**Key Methods:**
- `run_time_step()`: Advances simulation by one step
- `_calculate_aggregate_sentiment()`: Computes market mood
- `_calculate_net_order()`: Calculates order imbalance

## Usage Example

```python
raw_data = [{
    "profile": "Investor A",
    "conviction": 0.8,
    "sentiment": 0.6,
    "position": "BULLISH"
}]

processed = process_simulation_data(raw_data)
print(processed[0])  # Shows processed investor state
```

## Academic Constraints
1. Sentiment cannot exceed conviction (|S| â‰¤ |C|)
2. Price changes depend on net order imbalance
3. Agent behavior follows ABM principles from literature